{
	"name": "dfabibob",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "ABI_BOOK_OF_BUSSINESS_ALL_CARRIERS_APP_PROD",
						"type": "DatasetReference"
					},
					"name": "sourceabibob"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "ABI_FLORIDA_BOB_WEEKLY_EXTRACT_APP_PROD",
						"type": "DatasetReference"
					},
					"name": "sink1abibobfile"
				}
			],
			"transformations": [],
			"scriptLines": [
				"source(output(",
				"          E2EIS_SEQ_NUMBER as long,",
				"          AGENCY_IDENTIFIER as string,",
				"          AGENT_ID as string,",
				"          AGENT_NPN as string,",
				"          AGENT_FULL_NAME as string,",
				"          PLAN_NAME as string,",
				"          PRODUCT as string,",
				"          CONTRACT_ID as string,",
				"          CONTRACT_MEMBER_COUNT as integer,",
				"          MEMBER_RELATIONSHIP as string,",
				"          MEMBER_FIRST_NAME as string,",
				"          MEMBER_LAST_NAME as string,",
				"          MEMBER_DOB as date,",
				"          COUNTY_NAME as string,",
				"          AGENT_CONTRACT_START_DATE as date,",
				"          AGENT_CONTRACT_TERM_DATE as date,",
				"          EXCHANGE_INDICATOR as string,",
				"          MEMBER_PHONE_NUMBER as string,",
				"          MEMBER_EMAIL_ADDRESS as string,",
				"          MEMBER_FB_UID as string,",
				"          MWS_REGISTRATION as string,",
				"          PRODUCT_TYPE as string,",
				"          AGENT_STATUS as string,",
				"          REINSTATEMENT_INDICATOR as string,",
				"          MEMBER_AGE_IN_INDICATOR as string,",
				"          MEMBER_AGE_OUT_INDICATOR as string,",
				"          TOTAL_REWARDS_EARNED as string,",
				"          TOTAL_REWARDS_APPLIED_TO_PREMIUM as string,",
				"          TOTAL_REWARDS_APPLIED_TO_GIFT_CARD as string,",
				"          MEMBER_WELLNESS_ELIGIBILITY as string,",
				"          MEMBER_PARTICIPATION_WELLNESS_PROGRAM as string,",
				"          MEMBER_SPECIAL_ELIGIBILITY as string,",
				"          MEMBER_SPECIAL_PARTICIPATION as string,",
				"          MASTER_AGENCY_NAME as string,",
				"          MASTER_AGENCY_ID as string,",
				"          PRODUCT_ID as string,",
				"          MEMBER_PROVIDER_NAME as string,",
				"          PROVIDER_GROUP as string,",
				"          PCP_ASSIGNMENT as string,",
				"          BEST_AVAILABLE_ADDRESS as string,",
				"          BEST_AVAILABLE_ADDRESS_LINE_2 as string,",
				"          BEST_AVAILABLE_CITY_NAME as string,",
				"          BEST_AVAILABLE_STATE_NAME as string,",
				"          BEST_AVAILABLE_POSTAL_CODE as string,",
				"          COUNTY_CODE as string,",
				"          FFM_REG_STATUS as string,",
				"          CANCELLATION_REASON_CODE as string,",
				"          CANCELLATION_REASON as string,",
				"          APTC_EXPIRED_DAYS as string,",
				"          COVERAGE_EFFECTIVE_DATE as date,",
				"          COVERAGE_EXPIRATION_DATE as date,",
				"          MEMBER_ORIGINAL_EFFECTIVE_DATE as date,",
				"          METAL_LEVEL as string,",
				"          CONTRACT_STATUS as string,",
				"          PREMIUM_AMOUNT as string,",
				"          SCHEDULED_PAYMENT_DATE as date,",
				"          APTC_AMOUNT as string,",
				"          MEMBER_RESPONSIBILITY as string,",
				"          INCONSISTENCY_INDICATOR as string,",
				"          TOTAL_REWARDS_AVAILABLE_BALANCE as string,",
				"          CMS_CERT_STATUS as string,",
				"          ONBOARDING_INDICATOR as string,",
				"          SOURCE_SYSTEM as string,",
				"          SEGMENT as string,",
				"          AGENCY_ID as string,",
				"          RECORD_LOAD_DATE as date,",
				"          RECORD_LOADED_BY as string,",
				"          RECORD_DATA_SOURCE as string,",
				"          RECORD_FLAG_STATUS as string,",
				"          POLICY_ADDED_DATE as date,",
				"          POLICY_REMOVED_DATE as date,",
				"          POLICY_CANCELLED_DATE as date,",
				"          POLICY_REACTIVATION_DATE as date,",
				"          POLICY_RETENTION_DATE as date,",
				"          ADDS_MEMBER_COUNT as decimal(14,3),",
				"          CANCELS_MEMBER_COUNT as decimal(14,3),",
				"          ORIGINAL_POLICY_STATUS as string,",
				"          ACTIVITY_FLAG as string,",
				"          PERIOD_START_DATE as date,",
				"          PERIOD_END_DATE as date,",
				"          PERIOD_NAME as string,",
				"          PERIOD_DESCRIPTION as string,",
				"          BILL_STATUS as string,",
				"          File_Record_Birth_date as date",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: 'SELECT [E2EIS_SEQ_NUMBER]\\n      ,[AGENCY_IDENTIFIER]\\n      ,[AGENT_ID]\\n      ,[AGENT_NPN]\\n      ,[AGENT_FULL_NAME]\\n      ,[PLAN_NAME]\\n      ,[PRODUCT]\\n      ,[CONTRACT_ID]\\n      ,[CONTRACT_MEMBER_COUNT]\\n      ,[MEMBER_RELATIONSHIP]\\n      ,[MEMBER_FIRST_NAME]\\n      ,[MEMBER_LAST_NAME]\\n      ,[MEMBER_DOB]\\n      ,[COUNTY_NAME]\\n      ,[AGENT_CONTRACT_START_DATE]\\n      ,[AGENT_CONTRACT_TERM_DATE]\\n      ,[EXCHANGE_INDICATOR]\\n      ,[MEMBER_PHONE_NUMBER]\\n      ,[MEMBER_EMAIL_ADDRESS]\\n      ,[MEMBER_FB_UID]\\n      ,[MWS_REGISTRATION]\\n      ,[PRODUCT_TYPE]\\n      ,[AGENT_STATUS]\\n      ,[REINSTATEMENT_INDICATOR]\\n      ,[MEMBER_AGE_IN_INDICATOR]\\n      ,[MEMBER_AGE_OUT_INDICATOR]\\n      ,[TOTAL_REWARDS_EARNED]\\n      ,[TOTAL_REWARDS_APPLIED_TO_PREMIUM]\\n      ,[TOTAL_REWARDS_APPLIED_TO_GIFT_CARD]\\n      ,[MEMBER_WELLNESS_ELIGIBILITY]\\n      ,[MEMBER_PARTICIPATION_WELLNESS_PROGRAM]\\n      ,[MEMBER_SPECIAL_ELIGIBILITY]\\n      ,[MEMBER_SPECIAL_PARTICIPATION]\\n      ,[MASTER_AGENCY_NAME]\\n      ,[MASTER_AGENCY_ID]\\n      ,[PRODUCT_ID]\\n      ,[MEMBER_PROVIDER_NAME]\\n      ,[PROVIDER_GROUP]\\n      ,[PCP_ASSIGNMENT]\\n      ,[BEST_AVAILABLE_ADDRESS]\\n      ,[BEST_AVAILABLE_ADDRESS_LINE_2]\\n      ,[BEST_AVAILABLE_CITY_NAME]\\n      ,[BEST_AVAILABLE_STATE_NAME]\\n      ,[BEST_AVAILABLE_POSTAL_CODE]\\n      ,[COUNTY_CODE]\\n      ,[FFM_REG_STATUS]\\n      ,[CANCELLATION_REASON_CODE]\\n      ,[CANCELLATION_REASON]\\n      ,[APTC_EXPIRED_DAYS]\\n      ,[COVERAGE_EFFECTIVE_DATE]\\n      ,[COVERAGE_EXPIRATION_DATE]\\n      ,[MEMBER_ORIGINAL_EFFECTIVE_DATE]\\n      ,[METAL_LEVEL]\\n      ,[CONTRACT_STATUS]\\n      ,[PREMIUM_AMOUNT]\\n      ,[SCHEDULED_PAYMENT_DATE]\\n      ,[APTC_AMOUNT]\\n      ,[MEMBER_RESPONSIBILITY]\\n      ,[INCONSISTENCY_INDICATOR]\\n      ,[TOTAL_REWARDS_AVAILABLE_BALANCE]\\n      ,[CMS_CERT_STATUS]\\n      ,[ONBOARDING_INDICATOR]\\n      ,[SOURCE_SYSTEM]\\n      ,[SEGMENT]\\n      ,[RECORD_FLAG_STATUS]\\n      ,[POLICY_ADDED_DATE]\\n      ,[POLICY_REMOVED_DATE]\\n      ,[POLICY_CANCELLED_DATE]\\n      ,[POLICY_REACTIVATION_DATE]\\n      ,[POLICY_RETENTION_DATE]\\n      ,[ADDS_MEMBER_COUNT]\\n      ,[CANCELS_MEMBER_COUNT]\\n      ,[ORIGINAL_POLICY_STATUS]\\n      ,[ACTIVITY_FLAG]\\n      ,[PERIOD_START_DATE]\\n      ,[PERIOD_END_DATE]\\n      ,[PERIOD_NAME]\\n      ,[PERIOD_DESCRIPTION]\\n      ,[BILL_STATUS]\\n      ,[File_Record_Birth_date]\\n  FROM [ABI_101].[ABI_BOOK_OF_BUSSINESS_ALL_CARRIERS]\\n',",
				"     format: 'query') ~> sourceabibob",
				"sourceabibob sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     partitionFileNames:['ABI_FLORIDA_BOB_WEEKLY_EXTRACT_MMDDYYYY.csv'],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     partitionBy('hash', 1)) ~> sink1abibobfile"
			]
		}
	}
}