{
	"name": "dataflow5aiabob",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "AIA_BOOK_OF_BUSSINESS_ALL_CARRIERS_JOINED_ROD",
						"type": "DatasetReference"
					},
					"name": "AIA102OOSBOB"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "AIA_NATIONAL_BOB_WEEKLY_EXTRACT_PRD",
						"type": "DatasetReference"
					},
					"name": "AIA102DATAFLOW"
				}
			],
			"transformations": [],
			"scriptLines": [
				"source(output(",
				"          E2EIS_SEQ_NUMBER as long,",
				"          CARRIER as string,",
				"          OWNING_AGENT_OF_RECORD as string,",
				"          ASSIGNED_AGENT_NUMBER as string,",
				"          BROKER_START_DATE as string,",
				"          BROKER_END_DATE as string,",
				"          PRODUCT_TYPE as string,",
				"          PRODUCT_DESCRIPTION as string,",
				"          IMS_TRANSACTION_ID as string,",
				"          POLICY_STATUS as string,",
				"          POLICY_ID as string,",
				"          GROUP_NAME as string,",
				"          MEMBER_COUNT as string,",
				"          {ON/OFF_EXCHANGE} as string,",
				"          EXCHANGE_SUBSCRIBER_ID as string,",
				"          COVERAGE_TYPE as string,",
				"          SUBSCRIBER_ORIGINAL_EFFECTIVE_DATE as string,",
				"          COVERAGE_START__DATE as string,",
				"          COVERAGE_END_DATE as string,",
				"          PAID_THROUGH_DATE as string,",
				"          SUBSCRIBER_FIRST_NAME as string,",
				"          SUBSCRIBER_MIDDLE_NAME as string,",
				"          SUBSCRIBER_LAST_NAME as string,",
				"          SUBSCRIBER_FULL_NAME as string,",
				"          SUBSCRIBER_DOB as string,",
				"          SUBSCRIBER_EMAIL as string,",
				"          ADDRESS as string,",
				"          ADDRESS_2 as string,",
				"          ZIP_CODE as string,",
				"          CITY as string,",
				"          STATE as string,",
				"          COUNTY as string,",
				"          APP_SUBMIT_DATE as string,",
				"          MEMBER_PHONE_NUMBER_1 as string,",
				"          MEMBER_PHONE_NUMBER_2 as string,",
				"          COMPENSATION_TYPE as string,",
				"          COMPENSATION_PERIOD as string,",
				"          COMPENSATION_AMOUNT as string,",
				"          PAYEE_NAME as string,",
				"          MAIN_UPLINE_AGENT as string,",
				"          GROUP_TEAM_SALES as string,",
				"          TRANSITION_DATE as string,",
				"          ASSIGNED_AGENT_NAME as string,",
				"          AGENCY_ID as string,",
				"          RECORD_LOAD_DATE as date,",
				"          RECORD_LOADED_BY as string,",
				"          RECORD_DATA_SOURCE as string,",
				"          RECORD_FLAG_STATUS as string,",
				"          Comments as string,",
				"          POLICY_ADDED_DATE as date,",
				"          POLICY_REMOVED_DATE as date,",
				"          POLICY_CANCELLED_DATE as date,",
				"          POLICY_REACTIVATION_DATE as date,",
				"          POLICY_RETENTION_DATE as date,",
				"          ADDS_MEMBER_COUNT as decimal(14,3),",
				"          CANCELS_MEMBER_COUNT as decimal(14,3),",
				"          ORIGINAL_POLICY_STATUS as decimal(14,3),",
				"          ACTIVITY_FLAG as string,",
				"          Period_Start_date as date,",
				"          Period_End_date as date,",
				"          Period_Name as string,",
				"          Period_Description as string,",
				"          Bill_Status as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: 'SELECT\\n    E2EIS_SEQ_NUMBER,\\n    CARRIER,\\n    OWNING_AGENT_OF_RECORD,\\n    ASSIGNED_AGENT_NUMBER,\\n    BROKER_START_DATE,\\n    BROKER_END_DATE,\\n    PRODUCT_TYPE,\\n    PRODUCT_DESCRIPTION,\\n    IMS_TRANSACTION_ID,\\n    POLICY_STATUS,\\n    POLICY_ID,\\n    GROUP_NAME,\\n    MEMBER_COUNT,\\n    [ON/OFF_EXCHANGE] AS ON_OFF_EXCHANGE,\\n    EXCHANGE_SUBSCRIBER_ID,\\n    COVERAGE_TYPE,\\n    SUBSCRIBER_ORIGINAL_EFFECTIVE_DATE,\\n    COVERAGE_START_DATE,\\n    COVERAGE_END_DATE,\\n    PAID_THROUGH_DATE,\\n    SUBSCRIBER_FIRST_NAME,\\n    SUBSCRIBER_MIDDLE_NAME,\\n    SUBSCRIBER_LAST_NAME,\\n    SUBSCRIBER_FULL_NAME,\\n    SUBSCRIBER_DOB,\\n    SUBSCRIBER_EMAIL,\\n    ADDRESS,\\n    ADDRESS_2,\\n    ZIP_CODE,\\n    CITY,\\n    STATE,\\n    COUNTY,\\n    APP_SUBMIT_DATE,\\n    MEMBER_PHONE_NUMBER_1,\\n    MEMBER_PHONE_NUMBER_2,\\n    COMPENSATION_TYPE,\\n    COMPENSATION_PERIOD,\\n    COMPENSATION_AMOUNT,\\n    PAYEE_NAME,\\n    MAIN_UPLINE_AGENT,\\n    GROUP_TEAM_SALES,\\n    TRANSITION_DATE,\\n    ASSIGNED_AGENT_NAME,\\n    AGENCY_ID,\\n    RECORD_LOAD_DATE,\\n    RECORD_LOADED_BY,\\n    RECORD_DATA_SOURCE,\\n    RECORD_FLAG_STATUS,\\n    COMMENTS,\\n    POLICY_ADDED_DATE,\\n    POLICY_REMOVED_DATE,\\n    POLICY_CANCELLED_DATE,\\n    POLICY_REACTIVATION_DATE,\\n    POLICY_RETENTION_DATE,\\n    ADDS_MEMBER_COUNT,\\n    CANCELS_MEMBER_COUNT,\\n    ORIGINAL_POLICY_STATUS,\\n    ACTIVITY_FLAG,\\n    Period_Start_date,\\n    Period_End_date,\\n    Period_Name,\\n    Period_Description,\\n    Bill_Status,\\n    AGENCY_SUBSCRIBER_ORIG_EFFDATE,\\n    AGENCY_SUBSCRIBER_ORIG_EFFDATE_HIS\\nFROM (\\n    SELECT *,\\n           ROW_NUMBER() OVER (\\n               ORDER BY\\n                   CARRIER ASC,\\n                   POLICY_ID ASC,\\n                   POLICY_STATUS ASC,\\n                   COVERAGE_START_DATE DESC\\n           ) AS rn\\n    FROM [AIA_102].[AIA_BOOK_OF_BUSSINESS_ALL_CARRIERS_JOINED]\\n) t',",
				"     format: 'query') ~> AIA102OOSBOB",
				"AIA102OOSBOB sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          E2EIS_SEQ_NUMBER as string,",
				"          CARRIER as string,",
				"          OWNING_AGENT_OF_RECORD as string,",
				"          ASSIGNED_AGENT_NUMBER as string,",
				"          BROKER_START_DATE as string,",
				"          BROKER_END_DATE as string,",
				"          PRODUCT_TYPE as string,",
				"          PRODUCT_DESCRIPTION as string,",
				"          IMS_TRANSACTION_ID as string,",
				"          POLICY_STATUS as string,",
				"          POLICY_ID as string,",
				"          GROUP_NAME as string,",
				"          MEMBER_COUNT as string,",
				"          {ON/OFF_EXCHANGE} as string,",
				"          EXCHANGE_SUBSCRIBER_ID as string,",
				"          COVERAGE_TYPE as string,",
				"          SUBSCRIBER_ORIGINAL_EFFECTIVE_DATE as string,",
				"          COVERAGE_START__DATE as string,",
				"          COVERAGE_END_DATE as string,",
				"          PAID_THROUGH_DATE as string,",
				"          SUBSCRIBER_FIRST_NAME as string,",
				"          SUBSCRIBER_MIDDLE_NAME as string,",
				"          SUBSCRIBER_LAST_NAME as string,",
				"          SUBSCRIBER_FULL_NAME as string,",
				"          SUBSCRIBER_DOB as string,",
				"          SUBSCRIBER_EMAIL as string,",
				"          ADDRESS as string,",
				"          ADDRESS_2 as string,",
				"          ZIP_CODE as string,",
				"          CITY as string,",
				"          STATE as string,",
				"          COUNTY as string,",
				"          APP_SUBMIT_DATE as string,",
				"          MEMBER_PHONE_NUMBER_1 as string,",
				"          MEMBER_PHONE_NUMBER_2 as string,",
				"          COMPENSATION_TYPE as string,",
				"          COMPENSATION_PERIOD as string,",
				"          COMPENSATION_AMOUNT as string,",
				"          PAYEE_NAME as string,",
				"          MAIN_UPLINE_AGENT as string,",
				"          GROUP_TEAM_SALES as string,",
				"          TRANSITION_DATE as string,",
				"          ASSIGNED_AGENT_NAME as string,",
				"          AGENCY_ID as string,",
				"          RECORD_LOAD_DATE as string,",
				"          RECORD_LOADED_BY as string,",
				"          RECORD_DATA_SOURCE as string,",
				"          RECORD_FLAG_STATUS as string",
				"     ),",
				"     partitionFileNames:['AIA_NATIONAL_BOB_WEEKLY_EXTRACT_MMDDYYYY.csv'],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     partitionBy('hash', 1)) ~> AIA102DATAFLOW"
			]
		}
	}
}