{
	"name": "dfaiaemployeefile",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "AIA_AGENCY_PAYEE_DETAILS_AUTOMATION_TO_LOAD_PRD",
						"type": "DatasetReference"
					},
					"name": "DFAIAEMPLOYEEFILE"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "AIA_WEEKLY_EMPLOYEE_FILE_EXTRACTS",
						"type": "DatasetReference"
					},
					"name": "SINKAIAEMPLOYEEFILE"
				}
			],
			"transformations": [],
			"scriptLines": [
				"source(output(",
				"          E2EIS_SEQ_NUMBER as long,",
				"          CONTRACT_YEAR as string,",
				"          EMPLOYEE_TYPE as string,",
				"          EMPLOYEE_ID as string,",
				"          FULL_NAME as string,",
				"          PRIMARY_ROLE as string,",
				"          MONTHLY_RENEWAL_WRITING_AGENT_COMP_TIER as string,",
				"          PRE_ACA_WRITING_AGENT_COMP_TIER as string,",
				"          LTL_WRITING_AGENT_COMP_TIER as string,",
				"          MED_SUP_WRITING_AGENT_COMP_TIER as string,",
				"          DENTAL_NEWSALE_WRITING_AGENT_COMP_TIER as string,",
				"          ACA_NEWSALE_WRITING_AGENT_COMP_TIER as string,",
				"          GROUP_WRITING_AGENT_COMP_TIER as string,",
				"          ANCILLARY_RENEWAL_WRITING_AGENT_COMP_TIER as string,",
				"          PAYROLL_ID as string,",
				"          PAYEE_EMPLOYEE_ID as string,",
				"          PAYEE_NAME as string,",
				"          MAIN_UPLINE_EMPLOYEE_ID as string,",
				"          MAIN_UPLINE_FULL_NAME as string,",
				"          ROLE_END_DATE as date,",
				"          ROLE_END_REASON as string,",
				"          ALL_SALES_PAYEE as string,",
				"          SUBMITTING_AGENT as string,",
				"          SECONDARY_ROLE as string,",
				"          DEPARTMENT_ENTITY_ID as string,",
				"          DEPARTMENT_NAME as string,",
				"          {HEALTH_ACA_EMPLOYEE TIER} as string,",
				"          ADVANCE_OVERRIDE_PAYEE_ID as string,",
				"          AGENCY_ID as string,",
				"          RECORD_LOAD_DATE as date,",
				"          RECORD_LOADED_BY as string,",
				"          RECORD_DATA_SOURCE as string,",
				"          RECORD_FLAG_STATUS as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: 'Select \\n\\nCONTRACT_YEAR,EMPLOYEE_TYPE,EMPLOYEE_ID,FULL_NAME,PRIMARY_ROLE,MONTHLY_RENEWAL_WRITING_AGENT_COMP_TIER,\\n\\nPRE_ACA_WRITING_AGENT_COMP_TIER,LTL_WRITING_AGENT_COMP_TIER,MED_SUP_WRITING_AGENT_COMP_TIER,\\n\\nDENTAL_NEWSALE_WRITING_AGENT_COMP_TIER,ACA_NEWSALE_WRITING_AGENT_COMP_TIER,GROUP_WRITING_AGENT_COMP_TIER,\\n\\nANCILLARY_RENEWAL_WRITING_AGENT_COMP_TIER,PAYROLL_ID,PAYEE_EMPLOYEE_ID,PAYEE_NAME,MAIN_UPLINE_EMPLOYEE_ID,\\n\\nMAIN_UPLINE_FULL_NAME,ROLE_END_DATE,ROLE_END_REASON,ALL_SALES_PAYEE,SUBMITTING_AGENT,SECONDARY_ROLE,\\n\\nDEPARTMENT_ENTITY_ID,DEPARTMENT_NAME,[HEALTH_ACA_EMPLOYEE TIER],ADVANCE_OVERRIDE_PAYEE_ID\\n\\nfrom [AIA_102].AIA_AGENCY_PAYEE_DETAILS Where\\n\\nRECORD_LOAD_DATE in (Select max(RECORD_LOAD_DATE) from [AIA_102].AIA_AGENCY_PAYEE_DETAILS)\\n\\nunion\\n\\nSelect CONTRACT_YEAR,EMPLOYEE_TYPE,EMPLOYEE_ID,FULL_NAME,PRIMARY_ROLE,MONTHLY_RENEWAL_WRITING_AGENT_COMP_TIER,\\n\\nPRE_ACA_WRITING_AGENT_COMP_TIER,LTL_WRITING_AGENT_COMP_TIER,MED_SUP_WRITING_AGENT_COMP_TIER,\\n\\nDENTAL_NEWSALE_WRITING_AGENT_COMP_TIER,ACA_NEWSALE_WRITING_AGENT_COMP_TIER,GROUP_WRITING_AGENT_COMP_TIER,\\n\\nANCILLARY_RENEWAL_WRITING_AGENT_COMP_TIER,PAYROLL_ID,PAYEE_EMPLOYEE_ID,PAYEE_NAME,MAIN_UPLINE_EMPLOYEE_ID,\\n\\nMAIN_UPLINE_FULL_NAME,ROLE_END_DATE,ROLE_END_REASON,ALL_SALES_PAYEE,SUBMITTING_AGENT,SECONDARY_ROLE,\\n\\nDEPARTMENT_ENTITY_ID,DEPARTMENT_NAME,[HEALTH_ACA_EMPLOYEE TIER],ADVANCE_OVERRIDE_PAYEE_ID\\n\\nfrom [AIA_102].AIA_AGENCY_PAYEE_DETAILS_AUTOMATION_TO_LOAD',",
				"     format: 'query') ~> DFAIAEMPLOYEEFILE",
				"DFAIAEMPLOYEEFILE sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     input(",
				"          E2EIS_SEQ_NUMBER as string,",
				"          AGENCY_IDENTIFIER as string,",
				"          AGENT_ID as string,",
				"          AGENT_NPN as string,",
				"          AGENT_FULL_NAME as string,",
				"          PLAN_NAME as string,",
				"          PRODUCT as string,",
				"          CONTRACT_ID as string,",
				"          CONTRACT_MEMBER_COUNT as string,",
				"          MEMBER_RELATIONSHIP as string,",
				"          MEMBER_FIRST_NAME as string,",
				"          MEMBER_LAST_NAME as string,",
				"          MEMBER_DOB as string,",
				"          COUNTY_NAME as string,",
				"          AGENT_CONTRACT_START_DATE as string,",
				"          AGENT_CONTRACT_TERM_DATE as string,",
				"          EXCHANGE_INDICATOR as string,",
				"          MEMBER_PHONE_NUMBER as string,",
				"          MEMBER_EMAIL_ADDRESS as string,",
				"          MEMBER_FB_UID as string,",
				"          MWS_REGISTRATION as string,",
				"          PRODUCT_TYPE as string,",
				"          AGENT_STATUS as string,",
				"          REINSTATEMENT_INDICATOR as string,",
				"          MEMBER_AGE_IN_INDICATOR as string,",
				"          MEMBER_AGE_OUT_INDICATOR as string,",
				"          TOTAL_REWARDS_EARNED as string,",
				"          TOTAL_REWARDS_APPLIED_TO_PREMIUM as string,",
				"          TOTAL_REWARDS_APPLIED_TO_GIFT_CARD as string,",
				"          MEMBER_WELLNESS_ELIGIBILITY as string,",
				"          MEMBER_PARTICIPATION_WELLNESS_PROGRAM as string,",
				"          MEMBER_SPECIAL_ELIGIBILITY as string,",
				"          MEMBER_SPECIAL_PARTICIPATION as string,",
				"          MASTER_AGENCY_NAME as string,",
				"          MASTER_AGENCY_ID as string,",
				"          PRODUCT_ID as string,",
				"          MEMBER_PROVIDER_NAME as string,",
				"          PROVIDER_GROUP as string,",
				"          PCP_ASSIGNMENT as string,",
				"          BEST_AVAILABLE_ADDRESS as string,",
				"          BEST_AVAILABLE_ADDRESS_LINE_2 as string,",
				"          BEST_AVAILABLE_CITY_NAME as string,",
				"          BEST_AVAILABLE_STATE_NAME as string,",
				"          BEST_AVAILABLE_POSTAL_CODE as string,",
				"          COUNTY_CODE as string,",
				"          FFM_REG_STATUS as string,",
				"          CANCELLATION_REASON_CODE as string,",
				"          CANCELLATION_REASON as string,",
				"          APTC_EXPIRED_DAYS as string,",
				"          COVERAGE_EFFECTIVE_DATE as string,",
				"          COVERAGE_EXPIRATION_DATE as string,",
				"          MEMBER_ORIGINAL_EFFECTIVE_DATE as string,",
				"          METAL_LEVEL as string,",
				"          CONTRACT_STATUS as string,",
				"          PREMIUM_AMOUNT as string,",
				"          SCHEDULED_PAYMENT_DATE as string,",
				"          APTC_AMOUNT as string,",
				"          MEMBER_RESPONSIBILITY as string,",
				"          INCONSISTENCY_INDICATOR as string,",
				"          TOTAL_REWARDS_AVAILABLE_BALANCE as string,",
				"          CMS_CERT_STATUS as string,",
				"          ONBOARDING_INDICATOR as string,",
				"          SOURCE_SYSTEM as string,",
				"          SEGMENT as string,",
				"          AGENCY_ID as string,",
				"          RECORD_LOAD_DATE as string,",
				"          RECORD_LOADED_BY as string,",
				"          RECORD_DATA_SOURCE as string,",
				"          RECORD_FLAG_STATUS as string,",
				"          POLICY_ADDED_DATE as string,",
				"          POLICY_REMOVED_DATE as string,",
				"          POLICY_CANCELLED_DATE as string,",
				"          POLICY_REACTIVATION_DATE as string,",
				"          POLICY_RETENTION_DATE as string,",
				"          ADDS_MEMBER_COUNT as string,",
				"          CANCELS_MEMBER_COUNT as string,",
				"          ORIGINAL_POLICY_STATUS as string,",
				"          ACTIVITY_FLAG as string,",
				"          PERIOD_START_DATE as string,",
				"          PERIOD_END_DATE as string,",
				"          PERIOD_NAME as string,",
				"          PERIOD_DESCRIPTION as string,",
				"          BILL_STATUS as string,",
				"          POLICY_LAST_RECEIVED_DATE as string,",
				"          ALIGNED_AGENT_CODE as string,",
				"          ALIGNED_AGENT_NAME as string,",
				"          MAIN_UPLINE_NO as string,",
				"          MAIN_UPLINE_NAME as string,",
				"          GROUP_TEAM_SALES as string,",
				"          PAYEE_NAME as string,",
				"          WRTAGNT_COMMENTS as string,",
				"          IMS_TRANSACTION_ID as string",
				"     ),",
				"     partitionFileNames:['AIA_WEEKLY_EMPLOYEE_FILE_EXTRACTS_MMDDYYYY.csv'],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     partitionBy('hash', 1)) ~> SINKAIAEMPLOYEEFILE"
			]
		}
	}
}