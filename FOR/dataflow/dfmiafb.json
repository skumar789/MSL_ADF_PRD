{
	"name": "dfmiafb",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "MIA_BCBS_FB_COMISSIONS_CDR_PROD",
						"type": "DatasetReference"
					},
					"name": "sourcemiafbdetails"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "DelimitedText12",
						"type": "DatasetReference"
					},
					"name": "sinkmiafbdetails"
				}
			],
			"transformations": [],
			"scriptLines": [
				"source(output(",
				"          AGENCY_CODE as string,",
				"          AGENT_LAST_NAME as string,",
				"          AGENT_FIRST_NAME as string,",
				"          AGENT_CODE as string,",
				"          PRODUCT_TYPE as string,",
				"          COMP_TYPE as string,",
				"          SUBSCRIBER_LAST_NAME as string,",
				"          SUBSCRIBER_FIRST_NAME as string,",
				"          SUBSCRIBER_MIDDLE_NAME as string,",
				"          FB_UID as string,",
				"          MEMBER_CONTRACT_NO as string,",
				"          APP_ID as string,",
				"          ORIGINAL_EFFECTIVE_DATE as date,",
				"          BENEFIT_EFFECTIVE_DATE as date,",
				"          ACCOUNTING_DATE as date,",
				"          COMPENSATION_DATE as date,",
				"          CANCEL_DATE as date,",
				"          INITIAL_PAYMENT_DATE as date,",
				"          COMP_YEAR as string,",
				"          PRIOR_CARRIER_IND as string,",
				"          PRIOR_PLAN_TYPE as string,",
				"          EVENT_TYPE as string,",
				"          Flat_Rate as decimal(14,2),",
				"          COUNTY_NAME as string,",
				"          CMS_DATE as date,",
				"          CYCLE_YEAR as string,",
				"          ADMIN_FEE as decimal(14,2),",
				"          AGE_IN_POLICY as string,",
				"          EMPLOYEE_ID as string,",
				"          Coverag_From_Date as date,",
				"          Coverag_To_Date as date,",
				"          Payroll_Id as string,",
				"          Payee_Employee_Id as string,",
				"          Payee_Name as string,",
				"          Main_Upline_Employee_Id as string,",
				"          Main_Upline_Full_Name as string,",
				"          Group_Name as string,",
				"          Member_Count as long,",
				"          BILLING_PERIOD_FROM as date,",
				"          BILLING_PERIOD_TO as date,",
				"          File_Type as string,",
				"          TRANSACTION_ID as long,",
				"          Agent_Role as string,",
				"          COMM_AMOUNT as decimal(14,2),",
				"          Paticipant_Relation as string,",
				"          PERCENT_OF_FB_PAYMENT as decimal(18,8),",
				"          Agent_Commission as decimal(33,10),",
				"          E2E_PLAN_DESCRIPTION as string,",
				"          Comments as string,",
				"          Commission_Type as string,",
				"          Section_Name as string,",
				"          COMM_RATE_OR_FLAT_RATE as string,",
				"          AGENCY_COMP_TYPE as string,",
				"          FREQUENCY as string,",
				"          PAYMENT_TYPE as string,",
				"          AGENT_ASSIGNMENT as string,",
				"          PRODUCT_TYPE_CALC as string,",
				"          Accounting_Year as integer,",
				"          Role_As_Earned_Eligble_Count as integer,",
				"          Overide_Role_As_Earned_1_Eligble_Count as integer,",
				"          Overide_Role_2_As_Earned_Eligble_Count as integer,",
				"          Remaining_as_Earned_Months as integer,",
				"          Remaining_as_Earned_Commissions as decimal(14,3),",
				"          GROUP_WRITING_AGENT_COMP_TIER as string,",
				"          Active_Months as integer,",
				"          No_of_Months as integer,",
				"          AS_EARNED_END_DATE as date,",
				"          Participant_Relation_1 as string,",
				"          Participant_Relation_2 as string,",
				"          Segment as string,",
				"          CARRIER_AGENTCODE as string,",
				"          PERIOD_NAME as string,",
				"          Release_Schedule as string,",
				"          PAY_RECOVERY as string",
				"     ),",
				"     allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     isolationLevel: 'READ_UNCOMMITTED',",
				"     query: 'Select *from [AQI_104].[MIA_BCBS_FB_COMISSIONS]  where period_name = â€˜November 2025â€™\\n\\n',",
				"     format: 'query') ~> sourcemiafbdetails",
				"sourcemiafbdetails sink(allowSchemaDrift: true,",
				"     validateSchema: false,",
				"     partitionFileNames:['MIA_FB_ALL_SALES_DETAIL_NOVEMBER_2025_RUN1.csv'],",
				"     skipDuplicateMapInputs: true,",
				"     skipDuplicateMapOutputs: true,",
				"     partitionBy('hash', 1)) ~> sinkmiafbdetails"
			]
		}
	}
}